"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2156],{56371:function(e,t,n){var s=n(50029),i=n(92777),a=n(82262),r=n(59499),o=n(87794),c=n.n(o),l=n(19870),d=n.n(l),g=n(54774),u=n.n(g),m=n(11163),p=n(45840),h=n(83454);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,s)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var y=function(){function e(){(0,i.Z)(this,e),(0,r.Z)(this,"addOnMessageReceived",function(t,n){null!=t&&null!=n&&(e.messageReceivedListeners[t.toString()]=n)}),(0,r.Z)(this,"clearMessages",function(t){null!=t&&(e.messages=[])}),(0,r.Z)(this,"sendMessage",function(t){return"wss://139i13ygh4.execute-api.eu-west-1.amazonaws.com/prod/".includes("https")?(e.messages.push({message:t,messageTime:h.env.REACT_APP_TEST_DATE?new Date("Mon Aug 09 2021 16:24:35"):new Date,type:"sent",messageSubType:"text"}),e.socketClient&&e.socketClient.connected&&e.socketClient.send("/app/sendmessage",{},JSON.stringify(x(x({},{text:t,token:e.token,appName:"wss://139i13ygh4.execute-api.eu-west-1.amazonaws.com/prod/",profile:"professional"}),e.customerDetails))),e.messages):(e.messages.push({message:t,messageTime:h.env.REACT_APP_TEST_DATE?new Date("Mon Aug 09 2021 16:24:35"):new Date,type:"sent",messageSubType:"text"}),e.socketClient.readyState>0&&e.socketClient.send(JSON.stringify(x(x({},{action:"default",message:{text:t,token:e.token,appName:h.env.REACT_APP_ZURI_APP_NAME,name:e.customerDetails.name,phoneNumber:e.customerDetails.phoneNumber,profile:"professional"}}),e.customerDetails))),e.messages)}),"wss://139i13ygh4.execute-api.eu-west-1.amazonaws.com/prod/".includes("https")?e.sockJs&&e.token&&e.socketClient||e.initHttps():"wss://139i13ygh4.execute-api.eu-west-1.amazonaws.com/prod/".includes("wss")&&!(e.socketClient&&e.token)&&e.initWss()}return(0,a.Z)(e,null,[{key:"initHttps",value:function(){var t=this,n=(0,m.useRouter)();this.sockJs=new(d())("wss://139i13ygh4.execute-api.eu-west-1.amazonaws.com/prod/"),this.token="/maintenance"===n.pathname||"/zuri"===n.pathname?this.generateToken():this.getToken()||this.generateToken(),this.socketClient=u().over(e.sockJs),this.socketClient.debug=null,this.socketClient.connect({},(0,s.Z)(c().mark(function n(){var s;return c().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:s=function(e){for(var t=[],n=0;n<e.length;n+=1)e[n].url?t[n]="".concat(e[n].url,"\\").concat(e[n].text):t[n]=e[n].text;return t},t.socketClient&&t.socketClient.connected?t.socketClient.subscribe("/sendtoclient/".concat(t.token),function(n){var i=n?JSON.parse(n.body):{},a={type:"received",messageSubType:i.type,messageTime:new Date};"text"===i.type?a.message=i.details:"buttons"===i.type?(a.message=i.title,a.actions=i.details):"gif"===i.type?a.message=i.details:"advanced_buttons"===i.type&&(a.message=i.title,a.actions=s(i.details)),e.messages.push(a),Object.values(t.messageReceivedListeners).map(function(t){return null!=t&&t(a,e.messages),t})}):console.log("Unable to connect to Zuri");case 2:case"end":return n.stop()}},n)})))}},{key:"initWss",value:function(){var t=this;this.socketClient=new p.w3cwebsocket("wss://139i13ygh4.execute-api.eu-west-1.amazonaws.com/prod/"),this.token=this.getToken()||this.generateToken(),this.socketClient.onmessage=function(n){var s=n?JSON.parse(n.data):{},i={type:"received",messageSubType:s.type,messageTime:new Date};"text"===s.type?i.message=s.details:"buttons"===s.type?(i.message=s.title,i.actions=s.details):"gif"===s.type?i.message=s.details:"advanced_buttons"===s.type&&(i.message=s.title,i.actions=function(e){for(var t=[],n=0;n<e.length;n+=1)e[n].url?t[n]="".concat(e[n].url,"\\").concat(e[n].text):t[n]=e[n].text;return t}(s.details)),e.messages.push(i),Object.values(t.messageReceivedListeners).map(function(t){return null!=t&&t(i,e.messages),t})}}},{key:"generateToken",value:function(){return"".concat(Math.random().toString(26),"_").concat(Math.random().toString(26),"_").concat(Math.random().toString(26)).replace(/[^a-zA-Z]/g,"")}},{key:"setCustomerDetails",value:function(t){e.customerDetails=t}},{key:"setToken",value:function(t){e.token=t}},{key:"getToken",value:function(){return e.token}}]),e}();(0,r.Z)(y,"sockJs",null),(0,r.Z)(y,"token",null),(0,r.Z)(y,"customerDetails",{}),(0,r.Z)(y,"socketClient",null),(0,r.Z)(y,"messageReceivedListeners",{}),(0,r.Z)(y,"messages",[]),t.Z=y},14163:function(e,t,n){n.d(t,{Z:function(){return _},D:function(){return P}});var s=n(16835),i=n(67294),a=n(28889),r=n(86010),o=n(22318),c=n(41120),l=n(11163),d=n(24849),g=n(41749),u=n(56163),m=n.n(u),p=n(74333),h={src:"/_next/static/media/BlueTicks.c6e30b94.png",height:6,width:10,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAQAAADSmGXeAAAAT0lEQVR42iXJsQpFABhA4V+Z7x3udAd5C7snkEUxSTErq5nkLTzol+Rs55yQSKQROovSGC8ql97uEya5wax1+D6vsVldTr8I6ZMKf7Xs1RvTTSfHWVAI/gAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:5},f=n(31109),x={src:"/_next/static/media/Pre-to-Post-AD Desktop.a286b03b.png",height:269,width:714,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAADCAIAAAAhqtkfAAAAVklEQVR42gFLALT/AESwLTuvF1KyQGe4W1+2UUuyNlu1TF22TwBWsUirzqqqzqdSsz+dzJes0aigzZtht1MARK8sWrFPSrA2I6sAf8B3ocucjMSFNa0KGUwjm8PDJ1UAAAAASUVORK5CYII=",blurWidth:8,blurHeight:3},y=n(92116),b=n(85893),A=(0,c.Z)(function(e){return{sentContainer:{display:"flex",flexDirection:"column",alignItems:"flex-end",paddingRight:e.spacing(1),paddingTop:10,fontSize:12},sentMessageContainer:{maxWidth:"80%",overflowWrap:"break-word",backgroundColor:e.palette.primary.main,padding:e.spacing(1),borderRadius:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px 0px ").concat(e.spacing(1),"px")},sentMessage:{color:e.palette.white,overflowWrap:"break-word",fontSize:12,fontWeight:e.typography.fontWeightMediumBold},sentTime:{maxWidth:"100%",fontSize:10,fontWeight:e.typography.fontWeightMedium,lineHeight:2.5,color:e.palette.white,textAlign:"right",whiteSpace:"nowrap"},receivedContainer:{display:"flex",maxWidth:"93%"},receivedMessageHolder:{maxWidth:"80%"},receivedMessage:{overflowWrap:"break-word",backgroundColor:"rgb(67, 176, 42, 0.32)",color:e.palette.black.main,fontSize:12,fontWeight:e.typography.fontWeightMediumBold,marginTop:e.spacing(1),padding:e.spacing(1),borderRadius:"0px ".concat(e.spacing(1),"px ").concat(e.spacing(1),"px ").concat(e.spacing(1),"px"),marginLeft:e.spacing(1)},zuriProfilePic:{margin:e.spacing(1),height:32,width:32},blueTicks:{paddingLeft:5},receivedTime:{fontSize:10,fontWeight:e.typography.fontWeightMedium,lineHeight:2.5,overflowWrap:"break-word",textAlignLast:"end",marginLeft:e.spacing(1)},actionsContainer:{display:"flex",flexWrap:"wrap",marginTop:8,textAlign:"center",paddingLeft:"10%"},actionButton:{marginTop:e.spacing(1),backgroundColor:e.palette.primary.main,color:e.palette.white,borderRadius:4,fontSize:11},receivedImage:{width:"60%",height:"auto",marginTop:e.spacing(1),borderRadius:"0px ".concat(e.spacing(1),"px ").concat(e.spacing(1),"px ").concat(e.spacing(1),"px")}}}),w=function(e){var t=e.type,n=e.messageSubType,c=e.messageTime,l=e.message,u=e.actions,w=e.onActionSelected,v=e.index,k=e.lastIndex,Z=e.setTyping,j=e.firstVisit,S=e.setFirstVisit,T=e.mobilePage,C=A(),M=i.createRef(),z=i.useState(!0),N=(0,s.Z)(z,2),R=N[0],P=N[1],D=i.useState(!1),_=(0,s.Z)(D,2),W=_[0],E=_[1];(0,i.useEffect)(function(){"sent"===t&&v>1?Z(!0):Z(!1),v===k&&M&&null!=M.current&&M.current.scrollIntoView(!0),j?(P(!1),E(!1)):E(!0),T&&E(!0),S(!1)},[j,v,k,E,M,T,S]);var B=i.useState(null),L=(0,s.Z)(B,2),O=L[0],H=L[1],V="0".concat(c.getHours()).substr(-2),F=V>=12?"PM":"AM";V%=12;var I="0".concat(c.getMinutes()).substr(-2);V=V||12;var U,J,Q="".concat(V,":").concat(I," ").concat(F);return(0,b.jsx)(a.Z,{children:(0,b.jsx)(a.Z,{ref:M,className:"sent"===t?C.sentContainer:C.receivedContainer,children:"sent"===t?(0,b.jsx)(b.Fragment,{children:R&&(0,b.jsxs)(a.Z,{className:C.sentMessageContainer,children:[(0,b.jsx)(o.Z,{variant:"body1",className:C.sentMessage,children:l}),(0,b.jsxs)(o.Z,{variant:"body1",component:"div",className:C.sentTime,children:[Q,(0,b.jsx)(y.Z,{src:h,className:C.blueTicks})]})]})}):(0,b.jsx)(b.Fragment,{children:W&&(0,b.jsx)(b.Fragment,{children:(0,b.jsxs)(a.Z,{className:C.receivedMessageHolder,children:["gif"===(void 0===n?"text":n)?(0,b.jsx)(b.Fragment,{children:null==O&&(0,b.jsx)("img",{src:l,alt:"zuri",className:C.receivedImage,onError:function(e){e.target.src=x,H((0,b.jsx)(a.Z,{className:C.receivedMessage,style:{padding:48},children:(0,b.jsx)(d.Z,{fontSize:"large"})}))}})||O}):(0,b.jsxs)(g.Z,{container:!0,direction:"row",children:[(0,b.jsx)(f.b,{variables:{featureName:"valentine-view"},children:function(e){var t=e.getFeatureStatus;return(0,b.jsx)(b.Fragment,{children:t&&t.status?(0,b.jsx)(g.Z,{item:!0,xs:1,style:{paddingTop:"10px"},children:(0,b.jsx)(y.Z,{src:"/images/special-day/ValentineZuri.webp",alt:"zuri image",width:38,height:38,className:C.zuriProfilePic})}):(0,b.jsx)(g.Z,{item:!0,xs:1,style:{paddingTop:"10px"},children:(0,b.jsx)(y.Z,{src:p.Z,width:38,height:38,className:C.zuriProfilePic})})})}}),(0,b.jsx)(g.Z,{item:!0,xs:11,children:(0,b.jsxs)(a.Z,{className:C.receivedMessage,children:[(0,b.jsx)("div",{dangerouslySetInnerHTML:{__html:m()((J=" ",null!==l&&""!==l&&void 0!==l&&(J=l.replace(/\n/g,"</br>")),J))}}),(0,b.jsx)(o.Z,{variant:"body1",className:C.receivedTime,children:Q})]})})]}),v===k&&u&&(0,b.jsx)(g.Z,{container:!0,className:C.actionsContainer,direction:"row",spacing:9,children:u.map(function(e){return(0,b.jsx)(g.Z,{item:!0,xs:5,color:"primary",className:(0,r.default)(C.actionButton,"actionButtons"),style:{padding:"10px",marginInlineStart:"10px",maxWidth:"-webkit-fill-available"},onClick:function(){null!=w&&w(e,v)},children:e},e)})})]})})})})})},v=i.memo(w),k=n(33426),Z=n(17812),j=n(43910),S={handleSendMessage:null},T=(0,c.Z)(function(e){return{container:{width:"100%",boxShadow:"0 -3px 2px 0 rgba(0, 0, 0, 0.04)",display:"flex",flexDirection:"row"},messageField:{width:"100%",marginRight:e.spacing(1.5),marginLeft:e.spacing(1.5),marginBottom:e.spacing(1),marginTop:e.spacing(1.5),fontWeight:e.typography.fontWeightMediumBold,"& label.Mui-focused":{borderColor:e.palette.primary.main,fontSize:10},"& label.MuiInputLabel-root":{fontSize:12,fontWeight:600,backgroundColor:"white",paddingRight:"3px",paddingLeft:"3px"},"& div.MuiOutlinedInput-root":{borderRadius:e.spacing(1),padding:4}},sendButton:{marginRight:e.spacing(1)}}}),C=function(e){var t=e.sendMessage,n=T(),r=i.useState(""),o=(0,s.Z)(r,2),c=o[0],l=o[1],d=i.createRef();return S.handleSendMessage=function(){null!=t&&c.length>0&&t(c);var e=d.current.getElementsByClassName("MuiOutlinedInput-input");e.length>0&&(e[0].value=""),l("")},(0,b.jsxs)(a.Z,{className:n.container,children:[(0,b.jsx)(k.Z,{placeholder:"Type your message here...","data-testid":"textfield",variant:"outlined",margin:"dense",type:"text",autoFocus:!0,ref:d,fullWidth:!0,className:n.messageField,onChange:function(e){l(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&S.handleSendMessage()}}),c.length>0&&(0,b.jsx)(Z.Z,{color:"primary","aria-label":"send message",className:n.sendButton,"data-testid":"btn",onClick:function(){S.handleSendMessage()},children:(0,b.jsx)(j.Z,{})})]})},M=i.memo(C),z=n(21790),N=n(56371),R=n(13794),P={handleTyping:null,handleResize:null},D=(0,c.Z)(function(){return{rootContainer:{height:"100%"},messagesBox:{height:"100%",minHeight:"10vh"},fullHeightMessageBox:{overflowY:"scroll"},popUp:{maxHeight:"40vh",overflowY:"scroll"},fullHeightPadding:{paddingTop:128},typing:{fontSize:10,color:"#808285",paddingLeft:10,paddingBottom:10}}}),_=function(e){var t=e.messages,n=e.onActionSelected,c=e.sendMessage,d=e.fullHeight,g=e.firstVisit,u=e.setFirstVisit,m=e.mobilePage,p=void 0!==m&&m,h=e.windowDimensions,f=e.setWindowDimensions,x=e.getWindowDimensions,y=e.isMobileTablet,A=D(),w=(0,l.useRouter)(),k=i.useState(!1),Z=(0,s.Z)(k,2),j=Z[0],S=Z[1],T=h?h.height-160:"";return P.handleTyping=function(e){S(e)},(0,i.useEffect)(function(){if(y)return window.addEventListener("resize",P.handleResize),f(x()),P.handleResize=function(){f(x())},function(){return window.removeEventListener("resize",P.handleResize)}},[]),(0,b.jsxs)(a.Z,{className:(0,r.default)(A.rootContainer,d&&A.fullHeightPadding),children:[(0,b.jsx)(a.Z,{p:1,className:(0,r.default)(A.messagesBox,d?A.fullHeightMessageBox:A.popUp),style:d?{height:T}:{maxHeight:"40vh"},children:t.map(function(e,s){return(0,b.jsx)(v,{"data-test":"chat",messageTime:e.messageTime,type:e.type,messageSubType:e.messageSubType,message:e.message,actions:e.actions,onActionSelected:function(e,t){n(e,t)},index:s,lastIndex:t.length-1,setTyping:P.handleTyping,firstVisit:g,setFirstVisit:u,mobilePage:p},"".concat(s+1,"_").concat(e.type))})}),"/maintenance"!==w.pathname&&"/zuri"!==w.pathname&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(z.nW,{hideError:!0,loader:(0,b.jsx)("div",{}),children:function(e){var t=e.getCustomerInfo;return N.Z.customerDetails.name=t?t.firstName:"",null}}),(0,b.jsx)(R.Hb,{loader:(0,b.jsx)("div",{}),fetchPolicy:"network-only",hideError:!0,children:function(e){var t=e.getToken;return t&&t.status&&(N.Z.customerDetails.phoneNumber=t.mobileNumber.substr(-9)),null}})]}),j&&(0,b.jsx)(o.Z,{className:A.typing,children:"Zuri typingâ€¦."}),(0,b.jsx)(M,{sendMessage:function(e){c(e)}})]})}},82156:function(e,t,n){n.d(t,{Z:function(){return b}});var s=n(16835),i=n(67294),a=n(43832),r=n(22318),o=n(41120),c=n(28889),l=n(74333),d=n(92116),g=n(2108),u=n(85893),m=(0,g.default)((0,u.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 48 48",children:(0,u.jsx)("g",{transform:"scale(0.7) translate(1 5)",children:(0,u.jsxs)("g",{transform:"translate(-1105.859 -458.859) translate(-10 -10)",children:[(0,u.jsx)("g",{transform:"translate(1105.86 458.86)",children:(0,u.jsx)("circle",{id:"prefix__Ellipse_465-2",cx:"15.5",cy:"15.5",r:"15.5","data-name":"Ellipse 465",transform:"translate(9 6)",style:{fill:"#43b02a"}})}),(0,u.jsxs)("g",{id:"prefix__icon_secondary_glyph:cross_","data-name":"icon [secondary][glyph:cross]",transform:"translate(1119.208 470.611)",children:[(0,u.jsx)("path",{id:"prefix__icon_area",d:"M0 0H23V21H0z","data-name":"icon area",transform:"translate(-.349 .249)",style:{fill:"#fff",opacity:0}}),(0,u.jsxs)("g",{id:"prefix__icon",transform:"translate(6.138 5.099)",children:[(0,u.jsx)("path",{id:"prefix__line_1",d:"M0 14.667L0 0",style:{fill:"none",stroke:"#fff",strokeLinecap:"round"},"data-name":"line 1",transform:"rotate(45 5.186 12.519)"}),(0,u.jsx)("path",{id:"prefix__line_2",d:"M0 0L14.667 0",style:{fill:"none",stroke:"#fff",strokeLinecap:"round"},"data-name":"line 2",transform:"rotate(45)"})]})]})]})})}),"GreenCloseIcon"),p=n(31109),h=n(56371),f=n(14163),x={handleSendMessage:null,handleSelectedAction:null,handleClose:null},y=(0,o.Z)(function(e){return{rootContainer:{minWidth:"30%"},container:{borderRadius:e.spacing(1),backgroundColor:e.palette.primary.main,marginRight:-e.spacing(2),marginBottom:e.spacing(1)},titleBar:{display:"flex",flexDirection:"row",justifyContent:"space-between",borderRadius:8},titleImage:{height:26,width:26},titleLabel:{color:e.palette.white,fontSize:16,fontWeight:e.typography.fontWeightBold,marginLeft:"auto"},contentContainer:{background:e.palette.white,borderRadius:e.spacing(1)},minimizeContainer:{alignSelf:"center",marginLeft:"auto",marginRight:5,height:20,paddingTop:10},minimize:{width:20,height:2,borderRadius:2,backgroundColor:e.palette.white},messagesBox:{}}}),b=function(e){var t=y(),n=e.close,o=e.firstVisit,g=e.setFirstVisit,b=i.useState({messages:h.Z.messages}),A=(0,s.Z)(b,2),w=A[0],v=A[1],k=new h.Z;return k.addOnMessageReceived("zuri-pop-up",function(e,t){v({messages:t})}),x.handleSendMessage=function(e){v({messages:k.sendMessage(e)})},x.handleSelectedAction=function(e){x.handleSendMessage(e),v({messages:w.messages})},x.handleClose=function(){null!=n&&n(),k.clearMessages("zuri-pop-up"),g(!0)},(0,i.useEffect)(function(){o&&k.sendMessage("Hey")},[o,k]),(0,u.jsx)(a.Z,{maxWidth:"sm",children:(0,u.jsxs)(c.Z,{className:t.container,children:[(0,u.jsxs)(c.Z,{p:2,className:t.titleBar,children:[(0,u.jsx)(p.b,{variables:{featureName:"valentine-view"},children:function(e){var n=e.getFeatureStatus;return(0,u.jsx)(u.Fragment,{children:n&&n.status?(0,u.jsx)(d.Z,{src:"/images/special-day/ValentineZuri.webp",alt:"zuri image",width:38,height:38,className:t.titleImage}):(0,u.jsx)(d.Z,{src:l.Z,alt:"zuri image",width:38,height:38,className:t.titleImage})})}}),(0,u.jsx)(r.Z,{variant:"body1",className:t.titleLabel,children:"Ask Zuri"}),(0,u.jsx)(c.Z,{className:t.minimizeContainer,"data-testid":"box",onClick:function(){null!=n&&n()},children:(0,u.jsx)(c.Z,{className:t.minimize})}),(0,u.jsx)(m,{fontSize:"large",onClick:x.handleClose})]}),(0,u.jsx)(c.Z,{"data-testid":"box2",className:t.contentContainer,children:(0,u.jsx)(f.Z,{className:t.messageBox,onActionSelected:function(e){x.handleSelectedAction(e)},sendMessage:function(e){x.handleSendMessage(e)},messages:w.messages,firstVisit:o,setFirstVisit:g})})]})})}},74333:function(e,t){t.Z={src:"/_next/static/media/zuri.6aa9d254.png",height:68,width:68,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAABAklEQVR42mMAgYqDmVqHrh84UtmZ/2vZulm/rry4fNhulaAmAxhMZ9B8+/312xMnT/+3Z2D4Pz3W//+XT5//P/v07K3yEgZNhnMPTx/+DwTrNmz8GczA8L/Fiuf/iwf3fv4HgvOPzhxiePbh6a//QPDsxfP/Cco8/1fXlv7/9eP7fxB4/uHZLwYQ8R8I3n/68t9QSeb/6knd/2Hg+cdnvxiuPr9w+OOXX/9P3nz5s6ii6X9JXtL/h58//vwPBBeenD3M0H4sVevg1bNvj19+9H/j7jP/t5y8+v/Jj///77y89zZ+iznUJwsYNGfuWHxo25kzP/dcvfVz89Uzh3RW8IMlAQxPsfwV15EsAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8}}}]);